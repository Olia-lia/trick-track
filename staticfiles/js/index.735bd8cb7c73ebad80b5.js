!function(){"use strict";const e=document.querySelector(".sequencer__wrapper").querySelector(".sequencer__samples-list"),t=document.querySelector("#matrix").content.querySelector(".sequencer__samples-item"),n=()=>{const e=document.createElement("button");return e.classList.add("sequencer__cell"),e.type="button",e.tabIndex=0,e},c=e=>{const t=document.querySelectorAll(".slide-1"),n=document.querySelectorAll(".slide-2"),c=[];return c.push.apply(c,t[e].children),c.push.apply(c,n[e].children),c},r=(e,t)=>{t.forEach((n=>{const{cells:c}=n;c.forEach((r=>{const o=t.indexOf(n),s=e[o],l=c.indexOf(r,0);0!=r.played&&(s[l].style.borderColor=(e=>{const{played:t}=e;switch(t){case!0:return"#ff00ff";case!1:return"";case!1:default:return"#ffffff"}})(r))}))}))},o=document.querySelector(".slider__arrow--next"),s=document.querySelector(".slider__arrow--prev");let l=1;const u=e=>{document.querySelectorAll(".slider-tracker").forEach((t=>{const n=t.children;let c;for(e>n.length&&(l=1),e<1&&(l=n.length),c=0;c<n.length;c++)n[c].classList.remove("current-slide");n[l-1].classList.add("current-slide")}))};function a(e){u(l=e)}document.querySelector("#bpm"),document.querySelectorAll(".player"),document.getElementById("play"),document.getElementById("stop"),document.getElementById(".#sample"),document.querySelectorAll('[data-action="volume"]'),document.querySelectorAll('[data-action="panner"]');let d=["./samples/bdsh.wav","./samples/boom.wav","./samples/tsk.wav"];const i=((e,t)=>{const n=[];return e.map((e=>{const c=[];for(let e=0;e<t.length;e++){const n=Object.assign({},t[e]);c.push(n)}const r={line:e,cells:c};n.push(r)})),n})(d,(e=>{let t=[];for(let e=0;e<32;e++){const e={played:!1,checked:!1,disabled:!1};t.push(e)}return t})());i.forEach((c=>{(c=>{const{line:r,cells:o}=c,s=t.cloneNode(!0);s.querySelector(".button").textContent=r.replace(/^.*[\\\/]/,"").slice(0,-4),e.append(s),((e,t)=>{const c=document.createDocumentFragment(),r=document.createDocumentFragment();t.slice(0,16).forEach((e=>{const t=n();c.append(t)})),t.slice(16,32).forEach((e=>{const t=n();r.append(t)})),e[0].append(c),e[1].append(r)})(s.querySelectorAll(".sequencer__step-list"),o)})(c)}));const f=(()=>{const e=[];for(let t=0;t<3;t++){const n=c(t);e.push(n)}return e})();var p,m;m=i,(p=f).forEach((e=>{e.forEach((t=>t.addEventListener("click",(t=>{const n=p.indexOf(e,0),{cells:c}=m[n],r=t.target,o=e.indexOf(r,0);c[o].checked=!c[o].checked,r.style.background=(e=>{const{checked:t}=e;switch(t){case!0:return"#000000";case!1:default:return"#ffffff"}})(c[o])}))))})),o.addEventListener("click",(()=>{u(l+=1)})),s.addEventListener("click",(()=>{u(l-=1)}));let h=new(window.AudioContext||window.webkitAudioContext);const y=(e,t)=>{const n=h.createBufferSource();n.buffer=e;const c=h.createGain();n.connect(c).connect(h.destination),n.start(t)},E=new class{constructor(e,t){this.context=e,this.urls=t,this.buffer=[]}loadSound(e,t){let n=new XMLHttpRequest;n.open("get",e,!0),n.responseType="arraybuffer";let c=this;n.onload=function(){c.context.decodeAudioData(n.response,(function(e){c.buffer[t]=e}))},n.send()}createBuffer(){this.urls.forEach(((e,t)=>{this.loadSound(e,t)}))}getSound(e){return this.buffer[e]}}(h,d);E.createBuffer();let q=document.getElementsByClassName("button");var S=[];S.push.apply(S,q),S.forEach((e=>e.addEventListener("click",(t=>{e=t.target;const n=S.indexOf(e,0);y(E.getSound(n),0)}))));let b=0,g=0,w=0,k=60/bpm,v=!1;function _(){let e=h.currentTime;for(e-=b;g<e+.2;)A(i,g+b,r),x(i,a);setTimeout(_,0)}function x(e,t){w++,e.forEach((e=>{const{cells:t}=e;t.forEach((t=>{(t=e.cells[w-1])?t.played=!0:t.played=!1}))})),t(w>16?2:1),30===w&&(w=0),g+=k/4}function A(e,t,n){for(let n=0;n<e.length;n++)0!=e[n].cells[w].checked&&y(E.getSound(n),t);n(f,i)}document.addEventListener("keydown",(e=>{(e=>"Escape"===e.key)(e)&&(e.preventDefault(),v=!v,v=!0,w=w,g=0,b=h.currentTime+.005,_())}))}();
//# sourceMappingURL=index.735bd8cb7c73ebad80b5.js.map