!function(){"use strict";document.querySelector("#bars");const e=document.querySelector(".sequencer__wrapper").querySelector(".sequencer__samples-list"),t=document.querySelector("#matrix").content.querySelector(".sequencer__samples-item"),n=()=>{const e=document.createElement("button");return e.classList.add("sequencer__cell"),e.type="button",e.tabIndex=0,e},c=e=>{const t=document.querySelectorAll(".slide-1"),n=document.querySelectorAll(".slide-2"),c=[];return c.push.apply(c,t[e].children),c.push.apply(c,n[e].children),c},o=e=>{const t=document.querySelectorAll(".sequencer__playback-element");[...t].forEach((n=>{n==t[e-1]?n.classList.add("sequencer__playback-element--played"):n.classList.remove("sequencer__playback-element--played")}))},r=document.querySelector(".slider__arrow--next"),s=document.querySelector(".slider__arrow--prev");let l=1;const a=e=>{document.querySelectorAll(".slider-tracker").forEach((t=>{const n=t.children;let c;for(e>n.length&&(l=1),e<1&&(l=n.length),c=0;c<n.length;c++)n[c].classList.remove("current-slide");n[l-1].classList.add("current-slide")}))};function u(e){a(l=e)}const d=document.querySelector("#bpm");document.getElementById("play"),document.getElementById("stop"),document.getElementById(".#sample");let i=new(window.AudioContext||window.webkitAudioContext);const p=new class{constructor(e,t){this.context=e,this.urls=t,this.buffer=[]}loadSound(e,t){let n=new XMLHttpRequest;n.open("get",e,!0),n.responseType="arraybuffer";let c=this;n.onload=function(){c.context.decodeAudioData(n.response,(function(e){c.buffer[t]=e}))},n.send()}createBuffer(){this.urls.forEach(((e,t)=>{this.loadSound(e,t)}))}getSound(e){return this.buffer[e]}}(i,["./samples/bdsh.wav","./samples/boom.wav","./samples/tsk.wav"]);p.createBuffer();const m=(e=>{let t=[];for(let e=0;e<32;e++){const e={played:!1,checked:!1,disabled:!1};t.push(e)}return t})(),f=((e,t)=>{const n=[];return e.map((e=>{const c=[];for(let e=0;e<t.length;e++){const n=Object.assign({},t[e]);c.push(n)}const o={sound:e,cells:c,volume:1,panner:0};n.push(o)})),n})(p.urls,m);var h,y;f.forEach((c=>{(c=>{const{sound:o,cells:r}=c,s=t.cloneNode(!0);s.querySelector(".button").textContent=o.replace(/^.*[\\\/]/,"").slice(0,-4),e.append(s),((e,t)=>{const c=document.createDocumentFragment(),o=document.createDocumentFragment();t.slice(0,16).forEach((e=>{const t=n();c.append(t)})),t.slice(16,32).forEach((e=>{const t=n();o.append(t)})),e[0].append(c),e[1].append(o)})(s.querySelectorAll(".sequencer__step-list"),r)})(c)})),(()=>{const e=document.querySelector(".sequencer__playback"),t=document.createDocumentFragment();for(let e=0;e<32;e++){const e=document.createElement("div");e.classList.add("sequencer__playback-element"),t.append(e)}e.append(t)})(),h=(()=>{const e=[];for(let t=0;t<3;t++){const n=c(t);e.push(n)}return e})(),y=f,h.forEach((e=>{e.forEach((t=>t.addEventListener("click",(t=>{const n=h.indexOf(e,0),{cells:c}=y[n],o=t.target,r=e.indexOf(o,0);c[r].checked=!c[r].checked,o.style.background=(e=>{const{checked:t}=e;switch(t){case!0:return"#000000";case!1:default:return"#ffffff"}})(c[r])}))))})),r.addEventListener("click",(()=>{a(l+=1)})),s.addEventListener("click",(()=>{a(l-=1)})),d.addEventListener("change",(function(){d.value=this.value})),(e=>{(e=>{const t=document.querySelectorAll('[data-action="volume"]');t.forEach((n=>{n.addEventListener("input",(c=>{n=c.target;const o=[...t].indexOf(n,0);e[o].volume=c.target.value}))}))})(e),(e=>{const t=document.querySelectorAll('[data-action="panner"]');t.forEach((n=>{n.addEventListener("input",(c=>{n=c.target;const o=[...t].indexOf(n,0);e[o].panner=c.target.value,console.log(e)}))}))})(e)})(f);const v=(e,t,n,c)=>{const o=i.createBufferSource();o.buffer=e;const r=i.createGain();r.gain.value=n;const s=new StereoPannerNode(i,{pan:0});s.pan.value=c,o.connect(r).connect(s).connect(i.destination),o.start(t)};(()=>{let e=document.getElementsByClassName("button");var t=[];t.push.apply(t,e),t.forEach((e=>e.addEventListener("click",(n=>{e=n.target;const c=t.indexOf(e,0);v(p.getSound(c),0,1,0)}))))})();let q=0,E=0;function g(){let e=i.currentTime;for(e-=0;q<e+.2;)_(f,q+0,o),S(f,u);setTimeout(g,0)}function S(e,t){E++,e.forEach((e=>{const{cells:t}=e;t.forEach((t=>{(t=e.cells[E-1])?t.played=!0:t.played=!1}))})),t(E>16?2:1),30===E&&(E=0);let n=60/d.value/4;q+=n}function _(e,t,n){for(let n=0;n<e.length;n++){const c=e[n],o=c.volume,r=c.panner;0!=c.cells[E].checked&&v(p.getSound(n),t,o,r)}n(E)}document.addEventListener("keydown",(e=>{(e=>"Escape"===e.key)(e)&&(e.preventDefault(),g())}))}();
//# sourceMappingURL=main.js.map